<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- PWA Fullscreen Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Clock & Weather Station</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        html, body { width:100%; height:100%; overflow:hidden; background:#000; }
        @keyframes burninProtect { 0%,100%{transform:translate(-50%,-50%);}50%{transform:translate(-49%,-50%);} }
        #container {
            position:absolute; top:50%; left:50%;
            transform:translate(-50%,-50%);
            animation:burninProtect 600s infinite;
            color:#fff; font-family:'Orbitron',sans-serif; text-align:center;
            padding:env(safe-area-inset);
        }
        #clock { font-size:14rem; letter-spacing:4px; }
        #date { margin-top:0.5rem; font-size:2rem; }
        #city { margin-top:1rem; font-size:2.5rem; }
        #weather { margin-top:1.5rem; font-size:1.75rem; }
        #weather img { vertical-align:middle; width:50px; height:50px; }
        #forecast { margin-top:2rem; display:flex; justify-content:center; gap:1rem; flex-wrap:wrap; }
        .forecast-day { text-align:center; font-size:1.25rem; color:#fff; }
        .forecast-day .day-name { font-weight:bold; margin-bottom:0.3rem; }
        .forecast-day img { display:block; margin:0.3rem auto; width:48px; height:48px; }
        #fullscreen-prompt {
            position:absolute; bottom:20px; width:100%; text-align:center;
            color:#888; font-size:1rem; pointer-events:none;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="clock">00:00</div>
        <div id="date">Loading date...</div>
        <div id="city">Loading city...</div>
        <div id="weather">Loading weather...</div>
        <div id="forecast">Loading 5-day forecast...</div>
    </div>
    <div id="fullscreen-prompt">Tap anywhere to go fullscreen</div>
    <script>
        // Fullscreen trigger
        function enableFullscreen() {
            const el = document.documentElement;
            if (el.requestFullscreen) el.requestFullscreen();
            else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
            document.removeEventListener('click', enableFullscreen);
            document.getElementById('fullscreen-prompt').style.display = 'none';
        }
        document.addEventListener('click', enableFullscreen, { once: true });

        // Clock & Date
        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent =
                String(now.getHours()).padStart(2,'0') + ':' + String(now.getMinutes()).padStart(2,'0');
        }
        function updateDate() {
            const now = new Date();
            document.getElementById('date').textContent =
                now.toLocaleDateString(undefined, { weekday:'long', year:'numeric', month:'long', day:'numeric' });
        }
        updateClock(); setTimeout(()=>{ updateClock(); setInterval(updateClock,60000); }, (60-new Date().getSeconds())*1000);
        updateDate();

        // OpenWeatherMap OneCall for current + 5-day forecast
        const owmKey = 'YOUR_OPENWEATHERMAP_API_KEY'; // replace with your key
        function fetchWeather(lat, lon) {
            return fetch(
                `https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}` +
                `&exclude=minutely,hourly,alerts&units=metric&appid=${owmKey}`
            ).then(res=>res.json());
        }
        function render(lat, lon) {
            fetchWeather(lat, lon).then(data => {
                // City via reverse-geocoding
                fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${lat}&lon=${lon}&limit=1&appid=${owmKey}`)
                    .then(r=>r.json()).then(loc=>{
                        document.getElementById('city').textContent = loc[0]?.name || '';
                    });
                // Current
                const cur = data.current;
                document.getElementById('weather').innerHTML =
                    `<img src="https://openweathermap.org/img/wn/${cur.weather[0].icon}@2x.png" `+
                    `alt="${cur.weather[0].description}" /> ${Math.round(cur.temp)}°C ${cur.weather[0].description}`;
                // Forecast next 5 days
                const days = data.daily.slice(1,6);
                document.getElementById('forecast').innerHTML = days.map(day=>{
                    const d = new Date(day.dt*1000);
                    return `
                    <div class="forecast-day">
                        <div class="day-name">${d.toLocaleDateString(undefined,{weekday:'short'})}</div>
                        <img src="https://openweathermap.org/img/wn/${day.weather[0].icon}@2x.png" `+
                        `alt="${day.weather[0].description}" />
                        <div>${Math.round(day.temp.max)}° / ${Math.round(day.temp.min)}°</div>
                    </div>`;
                }).join('');
            }).catch(err=>console.error('Weather error:', err));
        }
        // Geolocation & refresh
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(pos=>{
                const lat=pos.coords.latitude, lon=pos.coords.longitude;
                render(lat,lon);
                setInterval(()=>render(lat,lon), 10*60*1000);
            }, ()=>console.error('Location denied.'));
        } else console.error('Geolocation unsupported.');
    </script>
</body>
</html>
